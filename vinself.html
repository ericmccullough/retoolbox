<!DOCTYPE html>
  <head>
    <script>
      function displayResult() {
        var hexPattern = /^[0-9a-f]{2}$/i;
        var chars = [];
        var result_string = ''
        var text = document.getElementById("PCAP_input").value.split(" ");
        for (var i = 0; i < text.length; i++) {
          if (hexPattern.test(text[i])) {
            chars.push(parseInt(text[i], 16));
          }
        }
        for (var i = chars.length; i > 0; i--) {
          result_string += String.fromCharCode(chars[i] ^ chars[i - 1]);
        }
        document.getElementById("results").value = result_string.split('').reverse().join('');
      }
    </script>
  </head>
  <body>
    <p>For more information on the Vinself malware see<br>http://www.fireeye.com/blog/technical/malware-research/2010/11/winself-a-new-backdoor-in-town.html</p>
    <div><label id='PCAP_input_lbl' for='PCAP_input'>Input from PCAP</label></div>
    <textarea id="PCAP_input" cols="80" rows="5" autofocus>
    00 4e 1d 49 7b 56 67   GIF89aP. ..O.H{Vg
  01d0  55 67 57 65 1f 32 7e 5e  74 54 03 59 17 3a 6d 2f   UgWe.2~^ tT.Y.:m/
  01e0  7c 5c 76 76 00 76 00 00  00 00 00 76 00 76 00 00   |\vv.v.. ...v.v..
  01f0  00 00 00 76 00 76 00 00  00 00 00 76 00 76 00 00   ...v.v.. ...v.v..
  0200  00 00 00 76 00 76 00 00  00 00 00 76 00 76 00 00   ...v.v.. ...v.v..
  0210  00 00 00 76 00 76 00 00  00 00                     ...v.v.. ..   P
      </textarea>
      <br>
      <button type="button" onclick="displayResult()">Decode</button>
      <div><label id='results_lbl' for='results'>Output</label></div>
      <div><textarea readonly id='results' cols="80" rows="5"></textarea></div>
  </body>
</html>